#include<stdio.h>
int main(){
    int p,f,frame[30],page[30],i,j,freq[30],last_used[30],time=0,pagefault=0,min_freq=0,lfu_index=0;
     printf("Enter number of pages: ");
    scanf("%d", &p);

    printf("Enter the page reference string: ");
    for (i = 0; i < p; i++) {
        scanf("%d", &page[i]);
    }

    printf("Enter number of frames: ");
    scanf("%d", &f);
    for(i=0;i<f;i++){
        frame[i]=-1;
        freq[i]=0;
        last_used[i]=0;
    }
    for(i = 0; i < p; i++){
        int empty_found=0,hit=0;
        time++;
        for(j=0;j<f;j++){
            if(frame[j]==page[i])
            {
               hit=1; 
               freq[j]++;
               last_used[j]=time;
               break;
            }
             
          } 
        if(!hit){
            pagefault++;
            for(j=0;j<f;j++){
                if(frame[j]==-1){
                    frame[j]=page[i];
                    freq[j]=1;
                    last_used[j]=time;
                    empty_found=1;
                    break;
                }
            }
            if(!empty_found){
                min_freq=freq[0];
                lfu_index=0;
                for(j=0;j<f;j++){
                    if(freq[j]<min_freq||(freq[j]==min_freq&&last_used[j]<last_used[lfu_index])){
                        min_freq=freq[j];
                        lfu_index=j;

                    }
                }
                frame[lfu_index]=page[i];
                freq[lfu_index]=1;
                last_used[lfu_index]=time;

            }

        }
        printf("\nFrames after page %d: ", page[i]);
        for (j = 0; j < f; j++) {
            if (frame[j] != -1)
                printf("%d ", frame[j]);
            else
                printf("- ");
        }
         if (!hit)
            printf("  (Page Fault)\n");
        else
            printf("  (hit)\n");
     }
      printf("\nTotal Page Faults: %d\n", pagefault);
    return 0;
}
